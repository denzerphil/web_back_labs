{% extends "base.html" %}

{% block lab %}Лабораторная работа 3 - Поиск товаров{% endblock %}

{% block main %}
    <h1>Поиск товаров по цене</h1>
    
    <div class="search-form">
        <form action="/lab3/products">
            <div>
                <label for="min_price">Минимальная цена:</label><br>
                <input type="number" id="min_price" name="min_price" 
                       placeholder="от {{ global_min_price }}"
                       value="{{ min_price or '' }}">
            </div>
            
            <div>
                <label for="max_price">Максимальная цена:</label><br>
                <input type="number" id="max_price" name="max_price" 
                       placeholder="до {{ global_max_price }}"
                       value="{{ max_price or '' }}">
            </div>
            
            <div class="form-buttons">
                <button type="submit">Искать</button>
                <a href="/lab3/products_reset" class="reset-btn">Сброс</a>
            </div>
        </form>
    </div>
    
    <div class="search-info">
        <p>
            <strong>Диапазон цен всех товаров:</strong> 
            от {{ global_min_price }} до {{ global_max_price }} руб.
        </p>
        
        {% if min_price or max_price %}
            <p>
                <strong>Текущий фильтр:</strong>
                {% if min_price %}от {{ min_price }}{% endif %}
                {% if max_price %}до {{ max_price }}{% endif %} руб.
            </p>
        {% endif %}
        
        <p><strong>Найдено товаров:</strong> {{ count }}</p>
    </div>
    
    {% if count == 0 and (min_price or max_price) %}
        <div class="no-results">
            <h3>Не найдено ни одного товара в заданном диапазоне цен</h3>
            <p>Попробуйте изменить параметры поиска.</p>
        </div>
    {% elif products %}
        <div class="products-list">
            <h2>Найденные товары ({{ count }}):</h2>
            
            <table class="products-table">
                <thead>
                    <tr>
                        <th>Название</th>
                        <th>Бренд</th>
                        <th>Цена (руб.)</th>
                        <th>Цвет</th>
                    </tr>
                </thead>
                <tbody>
                    {% for product in products %}
                    <tr>
                        <td>{{ product.name }}</td>
                        <td>{{ product.brand }}</td>
                        <td class="price">{{ product.price }}</td>
                        <td>{{ product.color }}</td>
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
        </div>
    {% else %}
        <div class="all-products">
            <h2>Все товары ({{ products|length }}):</h2>
            
            <table class="products-table">
                <thead>
                    <tr>
                        <th>Название</th>
                        <th>Бренд</th>
                        <th>Цена (руб.)</th>
                        <th>Цвет</th>
                    </tr>
                </thead>
                <tbody>
                    {% for product in products %}
                    <tr>
                        <td>{{ product.name }}</td>
                        <td>{{ product.brand }}</td>
                        <td class="price">{{ product.price }}</td>
                        <td>{{ product.color }}</td>
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
        </div>
    {% endif %}
    
    <style>
        .search-form {
            background-color: #f5f5f5;
            padding: 20px;
            border-radius: 10px;
            margin-bottom: 20px;
            max-width: 400px;
        }
        
        .search-form input {
            width: 100%;
            padding: 8px;
            margin-bottom: 10px;
            border: 1px solid #ddd;
            border-radius: 4px;
        }
        
        .form-buttons {
            display: flex;
            gap: 10px;
            margin-top: 15px;
        }
        
        .reset-btn {
            display: inline-block;
            padding: 8px 16px;
            background-color: #ff6b6b;
            color: white;
            text-decoration: none;
            border-radius: 4px;
        }
        
        .reset-btn:hover {
            background-color: #ff5252;
        }
        
        .search-info {
            background-color: #e8f4fc;
            padding: 15px;
            border-radius: 5px;
            margin-bottom: 20px;
        }
        
        .products-table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 20px;
        }
        
        .products-table th {
            background-color: #4CAF50;
            color: white;
            padding: 12px;
            text-align: left;
        }
        
        .products-table td {
            border: 1px solid #ddd;
            padding: 10px;
        }
        
        .products-table tr:nth-child(even) {
            background-color: #f9f9f9;
        }
        
        .products-table tr:hover {
            background-color: #f1f1f1;
        }
        
        .price {
            font-weight: bold;
            color: #2E7D32;
        }
        
        .no-results {
            background-color: #ffebee;
            padding: 20px;
            border-radius: 5px;
            text-align: center;
            margin-top: 20px;
        }
    </style>
{% endblock %}