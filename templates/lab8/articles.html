{% extends "lab8/base.html" %}

{% block lab %}Лабораторная работа 8 - Мои статьи{% endblock %}

{% block main %}
<h1>Мои статьи</h1>

<div class="navigation">
    <a href="/lab8/create" class="nav-btn">
        <i class="fas fa-plus"></i> Создать новую статью
    </a>
    <a href="/lab8/" class="nav-btn">
        <i class="fas fa-home"></i> На главную
    </a>
</div>

{% if user_articles %}
<h2>Ваши статьи ({{ user_articles|length }})</h2>
<div class="articles-list">
    {% for article in user_articles %}
    <div class="article-card {% if article.is_favorite %}favorite{% endif %}">
        <div class="article-header">
            <h3>{{ article.title }}</h3>
            <div class="article-meta">
                <span class="badge {% if article.is_public %}public{% else %}private{% endif %}">
                    {% if article.is_public %}Публичная{% else %}Приватная{% endif %}
                </span>
                <span class="badge {% if article.is_favorite %}favorite-badge{% endif %}">
                    {% if article.is_favorite %}★ Избранное{% endif %}
                </span>
                <span class="likes">
                    <i class="fas fa-heart"></i> {{ article.likes }}
                </span>
            </div>
        </div>
        <div class="article-content">
            <p>{{ article.article_text[:200] }}{% if article.article_text|length > 200 %}...{% endif %}</p>
        </div>
        <div class="article-actions">
            <a href="/lab8/edit/{{ article.id }}" class="btn btn-sm btn-edit">
                <i class="fas fa-edit"></i> Редактировать
            </a>
            <a href="/lab8/delete/{{ article.id }}" class="btn btn-sm btn-danger" 
               onclick="return confirm('Вы уверены, что хотите удалить эту статью?')">
                <i class="fas fa-trash"></i> Удалить
            </a>
        </div>
    </div>
    {% endfor %}
</div>
{% else %}
<div class="empty-state">
    <i class="fas fa-file-alt fa-3x"></i>
    <h3>У вас пока нет статей</h3>
    <p>Создайте свою первую статью!</p>
    <a href="/lab8/create" class="btn btn-primary">
        <i class="fas fa-plus"></i> Создать статью
    </a>
</div>
{% endif %}

{% if public_articles %}
<h2>Публичные статьи других пользователей ({{ public_articles|length }})</h2>
<div class="articles-list">
    {% for article in public_articles %}
    {% if article.login_id != current_user.id %}
    <div class="article-card public-article">
        <div class="article-header">
            <h3>{{ article.title }}</h3>
            <div class="article-meta">
                <span class="badge public">Публичная</span>
                <span class="author">Автор: {{ article.author.login }}</span>
                <span class="likes">
                    <i class="fas fa-heart"></i> {{ article.likes }}
                </span>
            </div>
        </div>
        <div class="article-content">
            <p>{{ article.article_text[:200] }}{% if article.article_text|length > 200 %}...{% endif %}</p>
        </div>
    </div>
    {% endif %}
    {% endfor %}
</div>
{% endif %}
{% endblock %}